# 5. 프록시 캐시

## 원 서버(origin server) 직접 접근

한국에 있는 클라이언트 -> 미국에 있는 원 서버(실제 리소스가 있는 서버)

이렇게 클라이언트와 서버의 물리적 거리가 멀면 요청과 응답을 주고 받는 데 시간이 오래 걸리게 된다.

한국 어딘가에 프록시 캐시 서버를 두고. 클라들이 이 프록시 서버에 접근하게 만든다.

예) 유튜브도 한국 사람들이 많이 보는 영상은 로딩이 빠르고, 많이 안 보는 영상은 느린데, 많이 보는 영상은 프록시 서버에 저장되어 있기 때문이다.

클라는 내 로컬에 저장되는 private 캐시, 프록시 서버는 public 캐시

프록시 서버의 운영 방식은 여러가지가 있겠지만 대표적으로

```
1. 클라1이 어떤 리소스를 처음으로 요청하면,
2. 프록시 서버에는 해당 리소스에 대한 캐시가 없으므로 원서버를 통해 리소스를 가져온 뒤
3. 프록시 캐시 서버에 해당 리소스를 저장 후 클라1에게 응답한다.
4. 그 다음부터 요청하는 클라2, 클라3는 동일한 리소스에 대해 프록시 서버에서 응답을 받을 수 있다.
5. 클라 1은 느리게 받고, 2, 3은 빠르게 받는다.
```

아니면 주기적으로 원 서버의 리소스를 프록시 서버에 밀어 넣을 수 있다.

## Cache-Control

캐시 지시어(directives) 기타

### Cache-Control: public

- 응답이 public 캐시에 저장되어도 됨

### Cache-Control: private

- 응답이 해당 사용자만을 위한 것임, Pivate 캐시에 저장해야 함(기본값)

### Cache-Control: s-maxage

- 프록시 캐시에만 적용되는 max-age

### Age: 00(초)(HTTP 헤더)

- 오리진 서버에서 응답 후 프록시 캐시 내에 머문 시간(초)
