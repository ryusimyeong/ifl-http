# 4. 비연결성 connectionless

TCP/IP는 연결을 유지한다.

예를 들어 클라이언트가 요청을 보내면 서버가 응답하고

클라2가 요청하면 서버도 응답한다.

이때 서버는 클라 1, 2와 연결을 계속 유지하고 있다.

클라이언트가 요청을 하지 않아도 서버와 클라가 계속 연결을 유지하고 있어야 하기 때문에 불필요한 리소스가 낭비된다.

## HTTP의 비연결성

HTTP는 기본적으로 연결을 유지하지 않는다.(connectionless)

요청이 있을 때만 연결 후 응답을 하고 연결을 끊어버린다.

서버 입장에서는 요청을 주고받을 때만 연결을 유지하기 때문에 최소한의 자원만을 사용할 수 있다.

일반적으로 초단위 이하의 빠른 속도로 응답이 완료되기 때문에

1시간 동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 작다.

> 예) 일반적인 사람은 웹 브라우저에서 계속 연속해서 검색 버튼을 누르지는 않는다.

따라서 비연결성을 통해 서버 자원을 매우 효율적으로 사용할 수 있다.

## 비연결성의 한계와 극복

TCP/IP연결을 매번 새로 맺어야 한다. 즉 3 way handshake를 매번 해야 해서 지연시간이 늘어난다.

웹 브라우저로 사이트를 요청하면 HTML뿐만 아니라 자바스크립트, css, 추가 이미지 등 수많은 자원이 함께 다운로드되는데,

이때마다 3 way handshake를 매번하면 당연히 연결시간만큼의 시간이 낭비된다.

하지만 요즘 HTTP는 **지속연결(Persistent Connections)**로 위 문제를 해결한다.

> HTTP2 HTTP3에서 지속연결이 훨씬 더 최적화

지속 연결을 하지 않으면 요청이 있을 때마다 연결하고 끊어서 연결, 끊는 시간이 계속 추가되지만

지속 연결을 하면 일정시간 동안 연결을 유지해서 요청과 응답이 모두 끝날때까지 연결시켜준다.

## 번외

정말 같은 시간에 딱 맞춰 대용량 트래픽 발생하는 때가 있다.

예를 들면 선착순 이벤트, 명절 KTX예약, 학과 수업 등록 등의 일이다.

최대한 스테이트리스하게 설계해놓고 이벤트 시간에 맞춰 서버를 증설하여 해결하는 게 정석이다.

불가피하게 스테이트풀을 유지해야 한다 하더라도

이벤트 버튼을 누르기 전까지는 순수한 HTML 페이지 만들어 놓는 등 하여

클릭의 시간을 좀 지연시키는 것이 좋다.
